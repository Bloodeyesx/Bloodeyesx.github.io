<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Darkroom State // Tracker</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --bg: #0a0a0a; --red: #ef4444; --border: #262626; }
        body { background: var(--bg); color: #e5e5e5; font-family: 'JetBrains Mono', monospace; overflow-x: hidden; }
        .crt-overlay {
            position: fixed; top: 0; left: 0; width: 100vw; height: 100vh;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.03), rgba(0, 255, 0, 0.01), rgba(0, 0, 255, 0.03));
            background-size: 100% 3px, 2px 100%; pointer-events: none; z-index: 100;
        }
        .bundle-card { background: #111; border: 1px solid var(--border); transition: 0.3s; }
        .bundle-card:hover { border-color: var(--red); transform: translateY(-5px); }
        .badge-new { background: var(--red); color: black; font-size: 8px; font-weight: 900; padding: 2px 5px; }
    </style>
</head>
<body class="p-6 md:p-12">
    <div class="crt-overlay"></div>
    <div class="max-w-7xl mx-auto relative z-10">
        <header class="flex justify-between items-end border-b border-neutral-900 pb-10 mb-12">
            <div>
                <h1 class="text-4xl font-bold tracking-tighter uppercase">Darkroom <span class="text-red-600">State</span></h1>
                <p class="text-neutral-600 text-[9px] uppercase tracking-[0.4em]">Archive Signal: <span id="status" class="text-green-500">Scanning</span></p>
            </div>
            <div id="clock" class="text-right font-bold text-xl text-neutral-500">00:00:00</div>
        </header>

        <div id="bundles-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
            </div>
    </div>

    <script>
        // Update Clock
        setInterval(() => {
            document.getElementById('clock').innerText = new Date().toLocaleTimeString('fr-FR', {hour12:false});
        }, 1000);

        async function loadArchive() {
            const container = document.getElementById('bundles-container');
            try {
                const res = await fetch('bundles_db.json');
                if (!res.ok) throw new Error("Offline");
                const data = await res.json();
                render(Object.values(data._default));
            } catch (e) {
                console.warn("Using Mock Data - Run through a server to use real JSON.");
                document.getElementById('status').innerText = "Simulation Mode";
                document.getElementById('status').className = "text-orange-500";
                render([
                    { id: "demo-1", title: "PROXMOX AUTOMATION", image: "https://hb.imgix.net/de5f6905c6b2ae49bbc65b51baa2920a99978b50.png", description: "System monitoring tools for homelabs.", published_at: new Date().toISOString(), link: "#" },
                    { id: "demo-2", title: "N8N WORKFLOWS", image: "https://hb.imgix.net/de5f6905c6b2ae49bbc65b51baa2920a99978b50.png", description: "Automation blueprints for developers.", published_at: new Date().toISOString(), link: "#" }
                ]);
            }
        }

        function render(items) {
            const container = document.getElementById('bundles-container');
            container.innerHTML = items.map(b => `
                <div class="bundle-card flex flex-col h-full overflow-hidden">
                    <div class="relative aspect-video bg-black">
                        <img src="${b.image}" class="object-cover w-full h-full opacity-40 hover:opacity-100 transition duration-700 grayscale hover:grayscale-0">
                        <div class="absolute top-2 left-2"><span class="badge-new">LOGGED</span></div>
                    </div>
                    <div class="p-5 flex-grow">
                        <span class="text-[8px] text-neutral-700 font-bold uppercase">${b.id}</span>
                        <h2 class="text-sm font-bold mt-2 mb-4 group-hover:text-red-500">${b.title}</h2>
                        <p class="text-[10px] text-neutral-500 italic mb-6">${b.description}</p>
                        <a href="${b.link}" target="_blank" class="mt-auto block text-center py-2 border border-neutral-800 text-red-500 text-[9px] uppercase tracking-widest hover:bg-red-600 hover:text-black transition">Open Archive</a>
                    </div>
                </div>
            `).join('');
        }
        loadArchive();
    </script>
</body>
</html>
